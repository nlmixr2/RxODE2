<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a dynamic ODE-based model object suitably for translation
into fast C code"><title>Create an ODE-based model specification — rxode2 • rxode2</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create an ODE-based model specification — rxode2"><meta property="og:description" content="Create a dynamic ODE-based model object suitably for translation
into fast C code"><meta property="og:image" content="https://nlmixr2.github.io/rxode2/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.13.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fas fa fas fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a>
    <a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 with piping ie %&gt;%</a>
    <a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a>
    <a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a>
    <a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6>
    <a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a>
    <a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a>
    <a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a>
    <a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a>
    <a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a>
    <a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a>
    <a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--dosing-events">
    <span class="fas fa fas fa-stethoscope"></span>
     
    Dosing/Events
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--dosing-events">
    <a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a>
    <a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a>
    <a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a>
    <a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--simulations">
    <span class="fas fa fas fa-desktop"></span>
     
    Simulations
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--simulations">
    <a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a>
    <a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a>
    <a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--help">
    <span class="fas fa fas fa-life-ring"></span>
     
    Help
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--help">
    <a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a>
    <a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a>
    <a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a>
    <a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changes/News</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--">
    <span class="fas fa fas fa-archive"></span>
     
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--">
    <a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a>
    <a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create an ODE-based model specification</h1>
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/HEAD/R/rxode2.R" class="external-link"><code>R/rxode2.R</code></a></small>
      <div class="d-none name"><code>rxode2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a dynamic ODE-based model object suitably for translation
into fast C code</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rxode2</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  modName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>,</span>
<span>  wd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  calcJac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calcSens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  collapseModel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  package <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  linCmtSens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linCmtA"</span>, <span class="st">"linCmtB"</span>, <span class="st">"linCmtC"</span><span class="op">)</span>,</span>
<span>  indLin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fullPrint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"rxode2.fullPrint"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">RxODE</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  modName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>,</span>
<span>  wd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  calcJac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calcSens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  collapseModel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  package <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  linCmtSens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linCmtA"</span>, <span class="st">"linCmtB"</span>, <span class="st">"linCmtC"</span><span class="op">)</span>,</span>
<span>  indLin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fullPrint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"rxode2.fullPrint"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rxode</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  modName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>,</span>
<span>  wd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extraC <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  calcJac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calcSens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  collapseModel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  package <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  linCmtSens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linCmtA"</span>, <span class="st">"linCmtB"</span>, <span class="st">"linCmtC"</span><span class="op">)</span>,</span>
<span>  indLin <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fullPrint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"rxode2.fullPrint"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>This is the ODE model specification.  It can be:</p><ul><li><p>a string containing the set of ordinary differential
equations (ODE) and other expressions defining the changes in
the dynamic system.</p></li>
<li><p>a file name where the ODE system equation is contained</p></li>
</ul><p>An ODE expression enclosed in <code>\{\}</code></p>
<p>(see also the <code>filename</code> argument). For
details, see the sections “Details” and
<code>rxode2 Syntax</code> below.</p></dd>


<dt>modName</dt>
<dd><p>a string to be used as the model name. This string
is used for naming various aspects of the computations,
including generating C symbol names, dynamic libraries,
etc. Therefore, it is necessary that <code>modName</code> consists of
simple ASCII alphanumeric characters starting with a letter.</p></dd>


<dt>wd</dt>
<dd><p>character string with a working directory where to
create a subdirectory according to <code>modName</code>. When
specified, a subdirectory named after the
“<code>modName.d</code>” will be created and populated with a
C file, a dynamic loading library, plus various other working
files. If missing, the files are created (and removed) in the
temporary directory, and the rxode2 DLL for the model is
created in the current directory named <code>rx_????_platform</code>, for
example <code>rx_129f8f97fb94a87ca49ca8dafe691e1e_i386.dll</code></p></dd>


<dt>filename</dt>
<dd><p>A file name or connection object where the
ODE-based model specification resides. Only one of <code>model</code>
or <code>filename</code> may be specified.</p></dd>


<dt>extraC</dt>
<dd><p>Extra c code to include in the model.  This can be
useful to specify functions in the model.  These C functions
should usually take <code>double</code> precision arguments, and
return <code>double</code> precision values.</p></dd>


<dt>debug</dt>
<dd><p>is a boolean indicating if the executable should be
compiled with verbose debugging information turned on.</p></dd>


<dt>calcJac</dt>
<dd><p>boolean indicating if rxode2 will calculate the
Jacobain according to the specified ODEs.</p></dd>


<dt>calcSens</dt>
<dd><p>boolean indicating if rxode2 will calculate the
sensitivities according to the specified ODEs.</p></dd>


<dt>collapseModel</dt>
<dd><p>boolean indicating if rxode2 will remove all
LHS variables when calculating sensitivities.</p></dd>


<dt>package</dt>
<dd><p>Package name for pre-compiled binaries.</p></dd>


<dt>...</dt>
<dd><p>ignored arguments.</p></dd>


<dt>linCmtSens</dt>
<dd><p>The method to calculate the linCmt() solutions</p></dd>


<dt>indLin</dt>
<dd><p>Calculate inductive linearization matrices and
compile with inductive linearization support.</p></dd>


<dt>verbose</dt>
<dd><p>When <code>TRUE</code> be verbose with the linear
compartmental model</p></dd>


<dt>fullPrint</dt>
<dd><p>When using <code>printf</code> within the model, if <code>TRUE</code>
print on every step (except ME/indLin), otherwise when <code>FALSE</code>
print only when calculating the <code>d/dt</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object (environment) of class <code>rxode2</code> (see Chambers and Temple Lang (2001))
consisting of the following list of strings and functions:</p>


<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="st">`</span><span class="at">model</span><span class="st">`</span> a character string holding the source model specification.</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> <span class="st">`</span><span class="at">get.modelVars</span><span class="st">`</span>a <span class="cf">function</span> that returns a list with <span class="dv">3</span> character</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    vectors, <span class="st">`</span><span class="at">params</span><span class="st">`</span>, <span class="st">`</span><span class="at">state</span><span class="st">`</span>, and <span class="st">`</span><span class="at">lhs</span><span class="st">`</span> of variable names used <span class="cf">in</span> the model</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    specification. These will be output when the model is <span class="fu">computed</span> (i.e., the ODE solved by integration).</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">solve</span><span class="st">`</span>{this <span class="cf">function</span> <span class="fu">solves</span> (integrates) the ODE. This</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      is done by passing the code to [<span class="fu">rxSolve</span>()].</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      This is as <span class="cf">if</span> you called <span class="st">`</span><span class="at">rxSolve(rxode2object, ...)</span><span class="st">`</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      but returns a matrix instead of a rxSolve object.</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">params</span><span class="st">`</span><span class="sc">:</span> a numeric named vector with values <span class="cf">for</span> every parameter</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">in</span> the ODE system; the names must correspond to the parameter</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>      identifiers used <span class="cf">in</span> the ODE specification;</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">events</span><span class="st">`</span><span class="sc">:</span> an <span class="st">`</span><span class="at">eventTable</span><span class="st">`</span> object describing the</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">input</span> (e.g., doses) to the dynamic system and observation</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      sampling time <span class="fu">points</span> (see  [<span class="fu">eventTable</span>()]);</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">inits</span><span class="st">`</span><span class="sc">:</span> a vector of initial values of the state variables</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>      (e.g., amounts <span class="cf">in</span> each compartment), and the order <span class="cf">in</span> this vector</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      must be the same as the state <span class="fu">variables</span> (e.g., PK<span class="sc">/</span>PD compartments);</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">stiff</span><span class="st">`</span><span class="sc">:</span> a <span class="fu">logical</span> (<span class="st">`</span><span class="at">TRUE</span><span class="st">`</span> by default) indicating whether</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      the ODE system is stiff or not.</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      For stiff ODE <span class="fu">systems</span> (<span class="st">`</span><span class="at">stiff = TRUE</span><span class="st">`</span>), <span class="st">`</span><span class="at">rxode2</span><span class="st">`</span> uses</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      the <span class="fu">LSODA</span> (Livermore Solver <span class="cf">for</span> Ordinary Differential Equations)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      Fortran package, which implements an automatic method switching</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> stiff and non<span class="sc">-</span>stiff problems along the integration interval,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      authored by Hindmarsh and <span class="fu">Petzold</span> (<span class="dv">2003</span>).</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      For non<span class="sc">-</span>stiff <span class="fu">systems</span> (<span class="st">`</span><span class="at">stiff = FALSE</span><span class="st">`</span>), <span class="st">`</span><span class="at">rxode2</span><span class="st">`</span> uses <span class="st">`</span><span class="at">DOP853</span><span class="st">`</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      an explicit Runge<span class="sc">-</span>Kutta method of order <span class="dv">8</span>(<span class="dv">5</span>, <span class="dv">3</span>) of Dormand and Prince</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      as implemented <span class="cf">in</span> C by Hairer and <span class="fu">Wanner</span> (<span class="dv">1993</span>).</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">trans_abs</span><span class="st">`</span><span class="sc">:</span> a <span class="fu">logical</span> (<span class="st">`</span><span class="at">FALSE</span><span class="st">`</span> by default) indicating</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      whether to fit a transit absorption term</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      (TODO<span class="sc">:</span> need further documentation and example);</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">atol</span><span class="st">`</span><span class="sc">:</span> a numeric absolute <span class="fu">tolerance</span> (<span class="fl">1e-08</span> by default);</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">rtol</span><span class="st">`</span><span class="sc">:</span> a numeric relative <span class="fu">tolerance</span> (<span class="fl">1e-06</span> by default).e</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      The output of \dQuote{solve} is a matrix with as many rows as there</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>      are sampled time points and as many columns as system variables</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>      (as defined by the ODEs and additional assignments <span class="cf">in</span> the rxode2 model</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>          code).}</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">isValid</span><span class="st">`</span> a <span class="cf">function</span> <span class="fu">that</span> (naively) checks <span class="cf">for</span> model validity,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>      namely that the C object code reflects the latest model</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>      specification.</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">version</span><span class="st">`</span> a string with the version of the <span class="st">`</span><span class="at">rxode2</span><span class="st">`</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">object</span> (not the package).</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">dynLoad</span><span class="st">`</span> a <span class="cf">function</span> with one <span class="st">`</span><span class="at">force = FALSE</span><span class="st">`</span> argument</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>      that dynamically loads the object code <span class="cf">if</span> needed.</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">dynUnload</span><span class="st">`</span> a <span class="cf">function</span> with no argument that unloads</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>      the model object code.</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">delete</span><span class="st">`</span> removes all created model files, including C and DLL files.</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>      The model object is no longer valid and should be removed, e.g.,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">rm(m1)</span><span class="st">`</span>.</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">run</span><span class="st">`</span> deprecated, use <span class="st">`</span><span class="at">solve</span><span class="st">`</span>.</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">get.index</span><span class="st">`</span> deprecated.</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="sc">*</span> <span class="st">`</span><span class="at">getObj</span><span class="st">`</span> <span class="fu">internal</span> (not user callable) function.</span></code></pre><p></p></div>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>Rx</code> in the name <code>rxode2</code> is meant to suggest the
abbreviation <em>Rx</em> for a medical prescription, and thus to
suggest the package emphasis on pharmacometrics modeling, including
pharmacokinetics (PK), pharmacodynamics (PD), disease progression,
drug-disease modeling, etc.</p>
<p>The ODE-based model specification may be coded inside a character
string or in a text file, see Section <em>rxode2 Syntax</em> below for
coding details.  An internal <code>rxode2</code> compilation manager
object translates the ODE system into C, compiles it, and
dynamically loads the object code into the current R session.  The
call to <code>rxode2</code> produces an object of class <code>rxode2</code> which
consists of a list-like structure (environment) with various member
functions (see Section <em>Value</em> below).</p>
<p>For evaluating <code>rxode2</code> models, two types of inputs may be
provided: a required set of time points for querying the state of
the ODE system and an optional set of doses (input amounts).  These
inputs are combined into a single <em>event table</em> object created
with the function <code><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable()</a></code> or <code><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et()</a></code>.</p>
<p>An <code>rxode2</code> model specification consists of one or more statements
optionally terminated by semi-colons <code>;</code> and optional comments (comments
are delimited by <code>#</code> and an end-of-line).</p>
<p>A block of statements is a set of statements delimited by curly braces,
<code>{ ... }</code>.</p>
<p>Statements can be either assignments, conditional <code>if</code>/<code>else if</code>/<code>else</code>,
<code>while</code> loops (can be exited by <code><a href="https://rdrr.io/r/base/Control.html" class="external-link">break</a></code>), special statements, or
printing statements (for debugging/testing)</p>
<p>Assignment statements can be:</p><ul><li><p><strong>simple</strong> assignments, where the left hand is an identifier (i.e.,
variable)</p></li>
<li><p>special <strong>time-derivative</strong> assignments, where the left hand
specifies the change of the amount in the corresponding state
variable (compartment) with respect to time e.g., <code>d/dt(depot)</code>:</p></li>
<li><p>special <strong>initial-condition</strong> assignments where the left hand
specifies the compartment of the initial condition being specified,
e.g. <code>depot(0) = 0</code></p></li>
<li><p>special model event changes including <strong>bioavailability</strong>
(<code>f(depot)=1</code>), <strong>lag time</strong> (<code>alag(depot)=0</code>), <strong>modeled rate</strong>
(<code>rate(depot)=2</code>) and <strong>modeled duration</strong> (<code>dur(depot)=2</code>). An
example of these model features and the event specification for the
modeled infusions the rxode2 data specification is found in <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-event-types.html">rxode2 events vignette</a>.</p></li>
<li><p>special <strong>change point syntax, or model times</strong>. These model times
are specified by <code>mtime(var)=time</code></p></li>
<li><p>special <strong>Jacobian-derivative</strong> assignments, where the left hand
specifies the change in the compartment ode with respect to a
variable. For example, if <code>d/dt(y) = dy</code>, then a Jacobian for this
compartment can be specified as <code>df(y)/dy(dy) = 1</code>. There may be
some advantage to obtaining the solution or specifying the Jacobian
for very stiff ODE systems. However, for the few stiff systems we
tried with LSODA, this actually slightly slowed down the solving.</p></li>
</ul><p>Note that assignment can be done by <code>=</code>, <code>&lt;-</code> or <code>~</code>.</p>
<p>When assigning with the <code>~</code> operator, the <strong>simple assignments</strong> and
<strong>time-derivative</strong> assignments will not be output.</p>
<p>Special statements can be:</p><ul><li><p><strong>Compartment declaration statements</strong>, which can change the default
dosing compartment and the assumed compartment number(s) as well as
add extra compartment names at the end (useful for multiple-endpoint
nlmixr models); These are specified by <code>cmt(compartmentName)</code></p></li>
<li><p><strong>Parameter declaration statements</strong>, which can make sure the input
parameters are in a certain order instead of ordering the parameters
by the order they are parsed. This is useful for keeping the
parameter order the same when using 2 different ODE models. These
are specified by <code>param(par1, par2,...)</code></p></li>
</ul><p>An example model is shown below:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>   <span class="co"># simple assignment</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   C2 <span class="ot">=</span> centr<span class="sc">/</span>V2;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># time-derivative assignment</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   d<span class="sc">/</span><span class="fu">dt</span>(centr) <span class="ot">=</span> F<span class="sc">*</span>KA<span class="sc">*</span>depot <span class="sc">-</span> CL<span class="sc">*</span>C2 <span class="sc">-</span> Q<span class="sc">*</span>C2 <span class="sc">+</span> Q<span class="sc">*</span>C3; </span></code></pre><p></p></div>
<p>Expressions in assignment and <code>if</code> statements can be numeric or logical.</p>
<p>Numeric expressions can include the following numeric operators <code>+, -, *, /, ^</code> and those mathematical functions defined in the C or the R math
libraries (e.g., <code>fabs</code>, <code>exp</code>, <code>log</code>, <code>sin</code>, <code>abs</code>).</p>
<p>You may also access the R’s functions in the <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Numerical-analysis-subroutines" class="external-link">R math libraries</a>,
like <code>lgammafn</code> for the log gamma function.</p>
<p>The <code>rxode2</code> syntax is case-sensitive, i.e., <code>ABC</code> is different than
<code>abc</code>, <code>Abc</code>, <code>ABc</code>, etc.</p><div class="section">
<h3 id="identifiers">Identifiers<a class="anchor" aria-label="anchor" href="#identifiers"></a></h3>


<p>Like R, Identifiers (variable names) may consist of one or more
alphanumeric, underscore <code>_</code> or period <code>.</code> characters, but the first
character cannot be a digit or underscore <code>_</code>.</p>
<p>Identifiers in a model specification can refer to:</p><ul><li><p>State variables in the dynamic system (e.g., compartments in a
pharmacokinetics model).</p></li>
<li><p>Implied input variable, <code>t</code> (time), <code>tlast</code> (last time point), and
<code>podo</code> (oral dose, in the undocumented case of absorption transit
models).</p></li>
<li><p>Special constants like <code>pi</code> or <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Mathematical-constants" class="external-link">R’s predefined constants</a>.</p></li>
<li><p>Model parameters (e.g., <code>ka</code> rate of absorption, <code>CL</code> clearance,
etc.)</p></li>
<li><p>Others, as created by assignments as part of the model
specification; these are referred as <em>LHS</em> (left-hand side)
variable.</p></li>
</ul><p>Currently, the <code>rxode2</code> modeling language only recognizes system state
variables and “parameters”, thus, any values that need to be passed from
R to the ODE model (e.g., <code>age</code>) should be either passed in the <code>params</code>
argument of the integrator function <code><a href="rxSolve.html">rxSolve()</a></code> or be in the supplied
event data-set.</p>
<p>There are certain variable names that are in the <code>rxode2</code> event tables.
To avoid confusion, the following event table-related items cannot be
assigned, or used as a state but can be accessed in the rxode2 code:</p><ul><li><p><code>cmt</code></p></li>
<li><p><code>dvid</code></p></li>
<li><p><code>addl</code></p></li>
<li><p><code>ss</code></p></li>
<li><p><code>rate</code></p></li>
<li><p><code>id</code></p></li>
</ul><p>However the following variables are cannot be used in a model
specification:</p><ul><li><p><code>evid</code></p></li>
<li><p><code>ii</code></p></li>
</ul><p>Sometimes rxode2 generates variables that are fed back to rxode2.
Similarly, nlmixr generates some variables that are used in nlmixr
estimation and simulation. These variables start with the either the
<code>rx</code> or <code>nlmixr</code> prefixes. To avoid any problems, it is suggested to not
use these variables starting with either the <code>rx</code> or <code>nlmixr</code> prefixes.</p>
</div>

<div class="section">
<h3 id="logical-operators">Logical Operators<a class="anchor" aria-label="anchor" href="#logical-operators"></a></h3>


<p>Logical operators support the standard R operators <code>==</code>, <code>!=</code> <code>&gt;=</code> <code>&lt;=</code>
<code>&gt;</code> and <code>&lt;</code>. Like R these can be in <code>if()</code> or <code>while()</code> statements,
<code><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse()</a></code> expressions. Additionally they can be in a standard
assignment. For instance, the following is valid:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">=</span> covm<span class="sc">*</span>(sexf <span class="sc">==</span> <span class="st">"female"</span>) <span class="sc">+</span> covm<span class="sc">*</span>(sexf <span class="sc">!=</span> <span class="st">"female"</span>)</span></code></pre><p></p></div>
<p>Notice that you can also use character expressions in comparisons. This
convenience comes at a cost since character comparisons are slower than
numeric expressions. Unlike R, <code>as.numeric</code> or <code>as.integer</code> for these
logical statements is not only not needed, but will cause an syntax
error if you try to use the function.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chamber, J. M. and Temple Lang, D. (2001)
<em>Object Oriented Programming in R</em>.
R News, Vol. 1, No. 3, September 2001.
<a href="https://cran.r-project.org/doc/Rnews/Rnews_2001-3.pdf" class="external-link">https://cran.r-project.org/doc/Rnews/Rnews_2001-3.pdf</a>.</p>
<p>Hindmarsh, A. C.
<em>ODEPACK, A Systematized Collection of ODE Solvers</em>.
Scientific Computing, R. S. Stepleman et al. (Eds.),
North-Holland, Amsterdam, 1983, pp. 55-64.</p>
<p>Petzold, L. R.
<em>Automatic Selection of Methods for Solving Stiff and Nonstiff
Systems of Ordinary Differential Equations</em>.
Siam J. Sci. Stat. Comput. 4 (1983), pp. 136-148.</p>
<p>Hairer, E., Norsett, S. P., and Wanner, G.
<em>Solving ordinary differential equations I, nonstiff problems</em>.
2nd edition, Springer Series in Computational Mathematics,
Springer-Verlag (1993).</p>
<p>Plevyak, J.
<em><code>dparser</code></em>, <a href="https://dparser.sourceforge.net/" class="external-link">https://dparser.sourceforge.net/</a>. Web. 12 Oct. 2015.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable()</a></code>, <code><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et()</a></code>, <code><a href="https://nlmixr2.github.io/rxode2et/reference/add.sampling.html">add.sampling()</a></code>, <code><a href="https://nlmixr2.github.io/rxode2et/reference/add.dosing.html">add.dosing()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Melissa Hallow, Wenping Wang and Matthew Fidler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Step 1 - Create a model specification</span></span></span>
<span class="r-in"><span><span class="va">ode</span> <span class="op">&lt;-</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">   # A 4-compartment model, 3 PK and a PD (effect) compartment</span></span></span>
<span class="r-in"><span><span class="st">   # (notice state variable names 'depot', 'centr', 'peri', 'eff')</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">   C2 = centr/V2;</span></span></span>
<span class="r-in"><span><span class="st">   C3 = peri/V3;</span></span></span>
<span class="r-in"><span><span class="st">   d/dt(depot) =-KA*depot;</span></span></span>
<span class="r-in"><span><span class="st">   d/dt(centr) = KA*depot - CL*C2 - Q*C2 + Q*C3;</span></span></span>
<span class="r-in"><span><span class="st">   d/dt(peri)  =                    Q*C2 - Q*C3;</span></span></span>
<span class="r-in"><span><span class="st">   d/dt(eff)  = Kin - Kout*(1-C2/(EC50+C2))*eff;</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">rxode</span><span class="op">(</span>model <span class="op">=</span> <span class="va">ode</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">rxode2 </span>2.0.13.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_ed77f9314e376e9468b10e55eac44a9c</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$state</span>: depot, centr, peri, eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$params</span>: V2, V3, KA, CL, Q, Kin, Kout, EC50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$lhs</span>: C2, C3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 2 - Create the model input as an EventTable,</span></span></span>
<span class="r-in"><span><span class="co"># including dosing and observation (sampling) events</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># QD (once daily) dosing for 5 days.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable</a></span><span class="op">(</span>amount.units <span class="op">=</span> <span class="st">"ug"</span>, time.units <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qd</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">10000</span>, nbr.doses <span class="op">=</span> <span class="fl">5</span>, dosing.interval <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample the system hourly during the first day, every 8 hours</span></span></span>
<span class="r-in"><span><span class="co"># then after</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qd</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qd</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">24</span> <span class="op">+</span> <span class="fl">8</span>, to <span class="op">=</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">24</span>, by <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 3 - set starting parameter estimates and initial</span></span></span>
<span class="r-in"><span><span class="co"># values of the state</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    KA <span class="op">=</span> <span class="fl">.291</span>, CL <span class="op">=</span> <span class="fl">18.6</span>,</span></span>
<span class="r-in"><span>    V2 <span class="op">=</span> <span class="fl">40.2</span>, Q <span class="op">=</span> <span class="fl">10.5</span>, V3 <span class="op">=</span> <span class="fl">297.0</span>,</span></span>
<span class="r-in"><span>    Kin <span class="op">=</span> <span class="fl">1.0</span>, Kout <span class="op">=</span> <span class="fl">1.0</span>, EC50 <span class="op">=</span> <span class="fl">200.0</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># init state variable</span></span></span>
<span class="r-in"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Step 4 - Fit the model to the data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">qd.cp</span> <span class="op">&lt;-</span> <span class="va">m1</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="va">theta</span>, events <span class="op">=</span> <span class="va">qd</span>, <span class="va">inits</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Assumed order of inputs: depot, centr, peri, eff</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">qd.cp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      time       C2        C3     depot    centr      peri      eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0  0.00000 0.0000000 10000.000    0.000    0.0000 1.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1 43.99334 0.9113641  7475.157 1768.532  270.6751 1.083968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    2 54.50866 2.6510696  5587.797 2191.248  787.3677 1.179529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]    3 51.65163 4.4243597  4176.966 2076.396 1314.0348 1.227523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]    4 44.37513 5.9432612  3122.347 1783.880 1765.1486 1.233503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]    5 36.46382 7.1389804  2334.004 1465.845 2120.2772 1.214084</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This returns a matrix.  Note that you can also</span></span></span>
<span class="r-in"><span><span class="co"># solve using name initial values. For example:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>eff <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qd.cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">theta</span>, events <span class="op">=</span> <span class="va">qd</span>, <span class="va">inits</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qd.cp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Solved rxode2 object ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      V2      V3      KA      CL       Q     Kin    Kout    EC50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  40.200 297.000   0.291  18.600  10.500   1.000   1.000 200.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> depot centr  peri   eff </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0     0     0     1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── First part of data (object): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 37 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time    C2    C3  depot centr  peri   eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    0   0   0     <span style="text-decoration: underline;">10</span>000     0     0   1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>    1  44.0 0.911  <span style="text-decoration: underline;">7</span>475. <span style="text-decoration: underline;">1</span>769.  271.  1.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>    2  54.5 2.65   <span style="text-decoration: underline;">5</span>588. <span style="text-decoration: underline;">2</span>191.  787.  1.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>    3  51.7 4.42   <span style="text-decoration: underline;">4</span>177. <span style="text-decoration: underline;">2</span>076. <span style="text-decoration: underline;">1</span>314.  1.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>    4  44.4 5.94   <span style="text-decoration: underline;">3</span>122. <span style="text-decoration: underline;">1</span>784. <span style="text-decoration: underline;">1</span>765.  1.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>    5  36.5 7.14   <span style="text-decoration: underline;">2</span>334. <span style="text-decoration: underline;">1</span>466. <span style="text-decoration: underline;">2</span>120.  1.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 31 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">qd.cp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rxode2-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also directly simulate from a nlmixr model</span></span></span>
<span class="r-in"><span> <span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fl">.291</span></span></span>
<span class="r-in"><span>     <span class="va">CL</span> <span class="op">&lt;-</span> <span class="fl">18.6</span></span></span>
<span class="r-in"><span>     <span class="va">V2</span> <span class="op">&lt;-</span> <span class="fl">40.2</span></span></span>
<span class="r-in"><span>     <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fl">10.5</span></span></span>
<span class="r-in"><span>     <span class="va">V3</span> <span class="op">&lt;-</span> <span class="fl">297.0</span></span></span>
<span class="r-in"><span>     <span class="va">Kin</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span></span>
<span class="r-in"><span>     <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span></span>
<span class="r-in"><span>     <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="fl">200.0</span></span></span>
<span class="r-in"><span>   <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="model.html">model</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="co"># A 4-compartment model, 3 PK and a PD (effect) compartment</span></span></span>
<span class="r-in"><span>     <span class="co"># (notice state variable names 'depot', 'centr', 'peri', 'eff')</span></span></span>
<span class="r-in"><span>     <span class="va">C2</span> <span class="op">&lt;-</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span></span>
<span class="r-in"><span>     <span class="va">C3</span> <span class="op">&lt;-</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span></span>
<span class="r-in"><span>     <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span></span>
<span class="r-in"><span>     <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span></span>
<span class="r-in"><span>     <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>  <span class="op">&lt;-</span>                    <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span></span>
<span class="r-in"><span>     <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span></span>
<span class="r-in"><span>     <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>   <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">u</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># this pre-compiles and displays the simulation model</span></span></span>
<span class="r-in"><span> <span class="va">u</span><span class="op">$</span><span class="va">simulationModel</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> using C compiler: ‘gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">rxode2 </span>2.0.13.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_55ce33c49a394df86f6f67e77d3b49fd</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$state</span>: depot, centr, peri, eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$params</span>: KA, CL, V2, Q, V3, Kin, Kout, EC50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB; font-weight: bold;">$lhs</span>: C2, C3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">qd.cp</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">u</span>, <span class="va">qd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">qd.cp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Solved rxode2 object ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      KA      CL      V2       Q      V3     Kin    Kout    EC50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.291  18.600  40.200  10.500 297.000   1.000   1.000 200.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> depot centr  peri   eff </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0     0     0     1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">── First part of data (object): ──</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 37 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time    C2    C3  depot centr  peri   eff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    0   0   0     <span style="text-decoration: underline;">10</span>000     0     0   1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>    1  44.0 0.911  <span style="text-decoration: underline;">7</span>475. <span style="text-decoration: underline;">1</span>769.  271.  1.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>    2  54.5 2.65   <span style="text-decoration: underline;">5</span>588. <span style="text-decoration: underline;">2</span>191.  787.  1.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>    3  51.7 4.42   <span style="text-decoration: underline;">4</span>177. <span style="text-decoration: underline;">2</span>076. <span style="text-decoration: underline;">1</span>314.  1.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>    4  44.4 5.94   <span style="text-decoration: underline;">3</span>122. <span style="text-decoration: underline;">1</span>784. <span style="text-decoration: underline;">1</span>765.  1.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>    5  36.5 7.14   <span style="text-decoration: underline;">2</span>334. <span style="text-decoration: underline;">1</span>466. <span style="text-decoration: underline;">2</span>120.  1.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 31 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthew L. Fidler, Melissa Hallow, Wenping Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

