#define _getRxSolve_ _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940230
#define simeps _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940231
#define simeta _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940232
#define _solveData _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940233
#define _assign_ptr _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940234
#define _rxRmModelLib _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940235
#define _rxGetModelLib _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940236
#define _old_c _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940237
#define _ptrid _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940238
#define _rxIsCurrentC _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940239
#define _sumPS _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940240
#define _prodPS _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940241
#define _prodType _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940242
#define _sumType _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940243
#define _update_par_ptr _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940244
#define _getParCov _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940245
#define linCmtA _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940246
#define linCmtC _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940247
#define linCmtB _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940248
#define _rxode2_rxAssignPtr _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940249
#define _rxQr _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940250
#define phi _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940251
#define logit _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940252
#define expit _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940253
#define gammap _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940254
#define gammaq _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940255
#define lowergamma _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940256
#define uppergamma _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940257
#define gammapInv _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940258
#define gammapDer _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940259
#define gammapInva _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940260
#define gammaqInv _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940261
#define gammaqInva _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940262
#define rxnorm _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940263
#define rxnormV _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940264
#define rxbinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940265
#define rxnbinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940266
#define rxnbinomMu _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940267
#define rxcauchy _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940268
#define rxchisq _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940269
#define rxexp _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940270
#define rxf _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940271
#define rxgeom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940272
#define rxgamma _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940273
#define rxbeta _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940274
#define rxpois _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940275
#define rxt_ _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940276
#define rxunif _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940277
#define rxweibull _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940278
#define rinorm _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940279
#define rinormV _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940280
#define ribinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940281
#define rinbinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940282
#define rinbinomMu _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940283
#define ricauchy _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940284
#define richisq _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940285
#define riexp _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940286
#define rif _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940287
#define rigeom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940288
#define rigamma _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940289
#define ribeta _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940290
#define ripois _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940291
#define rit_ _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940292
#define riunif _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940293
#define riweibull _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940294
#define _llikNorm _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940295
#define _llikNormDmean _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940296
#define _llikNormDsd _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940297
#define _llikPois _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940298
#define _llikPoisDlambda _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940299
#define _llikBinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940300
#define _llikBinomDprob _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940301
#define _llikNbinom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940302
#define _llikNbinomDprob _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940303
#define _llikNbinomMu _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940304
#define _llikNbinomMuDmu _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940305
#define _llikBeta _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940306
#define _llikBetaDshape1 _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940307
#define _llikBetaDshape2 _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940308
#define _llikT _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940309
#define _llikTDdf _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940310
#define _llikTDmean _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940311
#define _llikTDsd _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940312
#define _llikChisq _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940313
#define _llikChisqDdf _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940314
#define _llikExp _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940315
#define _llikExpDrate _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940316
#define _llikF _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940317
#define _llikFDdf1 _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940318
#define _llikFDdf2 _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940319
#define _llikGeom _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940320
#define _llikGeomDp _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940321
#define _llikUnif _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940322
#define _llikUnifDalpha _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940323
#define _llikUnifDbeta _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940324
#define _llikWeibull _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940325
#define _llikWeibullDshape _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940326
#define _llikWeibullDscale _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940327
#define _llikGamma _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940328
#define _llikGammaDshape _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940329
#define _llikGammaDrate _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940330
#define _llikCauchy _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940331
#define _llikCauchyDlocation _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940332
#define _llikCauchyDscale _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940333
#define _compareFactorVal _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940334
#define _sum _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940335
#define _sign _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940336
#define _prod _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940337
#define _max _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940338
#define _min _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940339
#define _transit4P _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940340
#define _transit3P _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940341
#define _assignFuns0 _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940342
#define _assignFuns _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940343
#define _rxord _rxmod1_68303d7e2c47a53f5a196b1d9b2a5940344
#include <rxode2_model_shared.h>
#define __MAX_PROD__ 0
#define _CMT CMT
#define _SYNC_simeps_ for (int _svari=_solveData->neps; _svari--;){  if (_solveData->svar[_svari] == 0) {V2 = _PP[0];};   if (_solveData->svar[_svari] == 1) {V3 = _PP[1];};   if (_solveData->svar[_svari] == 2) {KA = _PP[2];};   if (_solveData->svar[_svari] == 3) {CL = _PP[3];};   if (_solveData->svar[_svari] == 4) {Q = _PP[4];};   if (_solveData->svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData->svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData->svar[_svari] == 7) {EC50 = _PP[7];}; }
#define _SYNC_simeta_ for (int _ovari=_solveData->neta; _ovari--;){  if (_solveData->ovar[_ovari] == 0) {V2 = _PP[0];};   if (_solveData->ovar[_ovari] == 1) {V3 = _PP[1];};   if (_solveData->ovar[_ovari] == 2) {KA = _PP[2];};   if (_solveData->ovar[_ovari] == 3) {CL = _PP[3];};   if (_solveData->ovar[_ovari] == 4) {Q = _PP[4];};   if (_solveData->ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData->ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData->ovar[_ovari] == 7) {EC50 = _PP[7];}; }
#include "extraC.h"
_getRxSolve_t _getRxSolve_;
_simfun simeps;
_simfun simeta;
rx_solve *_solveData=NULL;
rxode2_assign_ptr _assign_ptr=NULL;
_rxRmModelLibType _rxRmModelLib=NULL;
_rxGetModelLibType _rxGetModelLib=NULL;
rxode2_ode_solver_old_c _old_c=NULL;
rxode2_fn0i _ptrid=NULL;
_rxIsCurrentC_type _rxIsCurrentC=NULL;
_rxSumType _sumPS=NULL;
_rxProdType _prodPS=NULL;
rxode2_fn0i _prodType=NULL;
rxode2_fn0i _sumType=NULL;
_update_par_ptr_p _update_par_ptr=NULL;
_getParCov_p _getParCov=NULL;
linCmtA_p linCmtA;
linCmtA_p linCmtC;
linCmtB_p linCmtB;
_rx_asgn _rxode2_rxAssignPtr=NULL;
_rx_asgn _rxQr=NULL;
rxode2_fn phi;
rxode2_fn3 logit;
rxode2_fn3 expit;
rxode2_fn2 gammap;
rxode2_fn2 gammaq;
rxode2_fn2 lowergamma;
rxode2_fn2 uppergamma;
rxode2_fn2 gammapInv;
rxode2_fn2 gammapDer;
rxode2_fn2 gammapInva;
rxode2_fn2 gammaqInv;
rxode2_fn2 gammaqInva;
rxode2i_fn2 rxnorm;
rxode2i_fn2 rxnormV;
rxode2i_rxbinom rxbinom;
rxode2i_rxbinom rxnbinom;
rxode2i_rxbinom rxnbinomMu;
rxode2i_fn2 rxcauchy;
rxode2i_fn rxchisq;
rxode2i_fn rxexp;
rxode2i_fn2 rxf;
rxode2i_ifn rxgeom;
rxode2i_fn2 rxgamma;
rxode2i_fn2 rxbeta;
rxode2i_ifn rxpois;
rxode2i_fn rxt_;
rxode2i_fn2 rxunif;
rxode2i_fn2 rxweibull;
rxode2i2_fn2 rinorm;
rxode2i2_fn2 rinormV;
rxode2i2_ribinom ribinom;
rxode2i2_ribinom rinbinom;
rxode2i2_ribinom rinbinomMu;
rxode2i2_fn2 ricauchy;
rxode2i2_fn richisq;
rxode2i2_fn riexp;
rxode2i2_fn2 rif;
rxode2i2_ifn rigeom;
rxode2i2_fn2 rigamma;
rxode2i2_fn2 ribeta;
rxode2i2_ifn ripois;
rxode2i2_fn rit_;
rxode2i2_fn2 riunif;
rxode2i2_fn2 riweibull;
rxode2_llikNormFun _llikNorm;
rxode2_llikNormFun _llikNormDmean;
rxode2_llikNormFun _llikNormDsd;
rxode2_llikPoisFun _llikPois;
rxode2_llikPoisFun _llikPoisDlambda;
rxode2_llikBinomFun _llikBinom;
rxode2_llikBinomFun _llikBinomDprob;
rxode2_llikBinomFun _llikNbinom;
rxode2_llikBinomFun _llikNbinomDprob;
rxode2_llikBinomFun _llikNbinomMu;
rxode2_llikBinomFun _llikNbinomMuDmu;
rxode2_llikBetaFun _llikBeta;
rxode2_llikBetaFun _llikBetaDshape1;
rxode2_llikBetaFun _llikBetaDshape2;
rxode2_llikTFun _llikT;
rxode2_llikTFun _llikTDdf;
rxode2_llikTFun _llikTDmean;
rxode2_llikTFun _llikTDsd;
rxode2_llikChisqFun _llikChisq;
rxode2_llikChisqFun _llikChisqDdf;
rxode2_llikExpFun _llikExp;
rxode2_llikExpFun _llikExpDrate;
rxode2_llikFFun _llikF;
rxode2_llikFFun _llikFDdf1;
rxode2_llikFFun _llikFDdf2;
rxode2_llikGeomFun _llikGeom;
rxode2_llikGeomFun _llikGeomDp;
rxode2_llikUnifFun _llikUnif;
rxode2_llikUnifFun _llikUnifDalpha;
rxode2_llikUnifFun _llikUnifDbeta;
rxode2_llikWeibullFun _llikWeibull;
rxode2_llikWeibullFun _llikWeibullDshape;
rxode2_llikWeibullFun _llikWeibullDscale;
rxode2_llikGammaFun _llikGamma;
rxode2_llikGammaFun _llikGammaDshape;
rxode2_llikGammaFun _llikGammaDrate;
rxode2_llikCauchyFun _llikCauchy;
rxode2_llikCauchyFun _llikCauchyDlocation;
rxode2_llikCauchyFun _llikCauchyDscale;
rxode2_compareFactorVal_fn _compareFactorVal;
double _prod(double *input, double *p, int type, int n, ...){
  va_list valist;
  va_start(valist, n);
  for (unsigned int i = 0; i < n; i++){
    input[i] = va_arg(valist, double);
  }
  va_end(valist);
  return _prodPS(input, p, n, type);
}
double _sum(double *input, double *pld, int m, int type, int n, ...){
  va_list valist;
  va_start(valist, n);
  for (unsigned int i = 0; i < n; i++){
    input[i] = va_arg(valist, double);
  }
  va_end(valist);
  double ret = _sumPS(input, n, pld, m, type);
  if (type == 2 && m < 0){
    for (int i = -m; i--;){
      pld[i] = 0.0;
    }
  }
  return ret;
}
double _sign(unsigned int n, ...) {
  va_list valist;
  va_start(valist, n);
  double s = 1;
  for (unsigned int i = 0; i < n; i++) {
    s = sign(va_arg(valist, double))*s;
    if (s == 0){
      break;
    }
  }
  va_end(valist);
  return s;
}
double _rxord(int _cSub, unsigned int n,  ...) {
  rx_solving_options_ind* ind = &(_solveData->subjects[_cSub]);
  if (!ind->inLhs) {
    return 1.0;
  }
  va_list valist;
  va_start(valist, n);
  double ret = 1.0;
  double p = 0.0;
  double u = rxunif(ind, 0.0, 1.0);
  int found = 0;
  for (unsigned int i = 0; i < n; i++) {
    p += va_arg(valist, double);
    if (!found) {
      if (u < p) {
        ret = (double)(i+1);
        found = 1;
      }
    }
  }
  if (!found) ret =(double)(n+1);
  va_end(valist);
  return ret;
}
double _max(unsigned int n, ...) {
  va_list valist;
  va_start(valist, n);
  double mx = NA_REAL;
  double tmp = 0;
  if (n >= 1){
    mx = va_arg(valist, double);
    for (unsigned int i = 1; i < n; i++) {
      tmp = va_arg(valist, double);
      if (tmp>mx) mx=tmp;
    }
    va_end(valist);
  }
  return mx;
}
double _min(unsigned int n, ...){
  va_list valist;
  va_start(valist, n);
  double mn = NA_REAL;
  double tmp = 0;
  if (n >= 1){
    mn = va_arg(valist, double);
    for (unsigned int i = 1; i < n; i++){
      tmp = va_arg(valist, double);
      if (tmp<mn) mn=tmp;
    }
    va_end(valist);
  }
  return mn;
}
double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){
  double nd = (double) n;
  double ktr = (nd+1)/mtt;
  double lktr = _safe_log(nd+1)-_safe_log(mtt);
  double tlast = _solveData->subjects[id].tlastS[cmt];
  if (ISNA(tlast)) tlast = 0.0;
  double tad = (t-tlast);
  return exp(_safe_log(bio*(_solveData->subjects[id].curDoseS[cmt]))+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));
}
double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){
  double nd = (double) n;
  double ktr = (nd+1)/mtt;
  double lktr = _safe_log(nd+1)-_safe_log(mtt);
  double tlast = _solveData->subjects[id].tlastS[cmt];
  if (ISNA(tlast)) tlast = 0.0;
  double tad = t-tlast;
  double podo = _solveData->subjects[id].curDoseS[cmt];
  return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));
}
void _assignFuns0() {
  _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");
  _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");
  _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");
  _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");
  _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");
  _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");
  _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");
  _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");
  _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");
  _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");
  _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");
  _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");
  linCmtA=(linCmtA_p)R_GetCCallable("rxode2", "linCmtA");
  linCmtB=(linCmtB_p)R_GetCCallable("rxode2", "linCmtB");
  linCmtC=(linCmtA_p)R_GetCCallable("rxode2", "linCmtC");
    
  rxnorm = (rxode2i_fn2)R_GetCCallable("rxode2", "rxnorm");
  rxnormV = (rxode2i_fn2)R_GetCCallable("rxode2", "rxnormV");
  rxbinom = (rxode2i_rxbinom)R_GetCCallable("rxode2","rxbinom");
  rxnbinom = (rxode2i_rxbinom)R_GetCCallable("rxode2","rxnbinom");
  rxnbinomMu = (rxode2i_rxbinom)R_GetCCallable("rxode2","rxnbinomMu");
  rxcauchy = (rxode2i_fn2)R_GetCCallable("rxode2","rxcauchy") ;
  rxchisq = (rxode2i_fn)R_GetCCallable("rxode2","rxchisq") ;
  rxexp = (rxode2i_fn)R_GetCCallable("rxode2","rxexp");
  rxf = (rxode2i_fn2)R_GetCCallable("rxode2","rxf") ;
  rxgeom = (rxode2i_ifn)R_GetCCallable("rxode2","rxgeom") ;
  rxgamma = (rxode2i_fn2)R_GetCCallable("rxode2","rxgamma") ;
  rxbeta = (rxode2i_fn2)R_GetCCallable("rxode2","rxbeta") ;
  rxpois = (rxode2i_ifn)R_GetCCallable("rxode2","rxpois") ;
  rxt_ = (rxode2i_fn)R_GetCCallable("rxode2","rxt_") ;
  rxunif = (rxode2i_fn2)R_GetCCallable("rxode2","rxunif") ;
  rxweibull = (rxode2i_fn2)R_GetCCallable("rxode2","rxweibull");
  rinorm = (rxode2i2_fn2)R_GetCCallable("rxode2", "rinorm");
  rinormV = (rxode2i2_fn2)R_GetCCallable("rxode2", "rinormV");
  ribinom = (rxode2i2_ribinom)R_GetCCallable("rxode2","ribinom");
  rinbinom = (rxode2i2_ribinom)R_GetCCallable("rxode2","rinbinom");
  rinbinomMu = (rxode2i2_ribinom)R_GetCCallable("rxode2","rinbinomMu");
  ricauchy = (rxode2i2_fn2)R_GetCCallable("rxode2","ricauchy") ;
  richisq = (rxode2i2_fn)R_GetCCallable("rxode2","richisq") ;
  riexp = (rxode2i2_fn)R_GetCCallable("rxode2","riexp");
  rif = (rxode2i2_fn2)R_GetCCallable("rxode2","rif") ;
  rigeom = (rxode2i2_ifn)R_GetCCallable("rxode2","rigeom") ;
  rigamma = (rxode2i2_fn2)R_GetCCallable("rxode2","rigamma") ;
  ribeta = (rxode2i2_fn2)R_GetCCallable("rxode2","ribeta") ;
  ripois = (rxode2i2_ifn)R_GetCCallable("rxode2","ripois") ;
  rit_ = (rxode2i2_fn)R_GetCCallable("rxode2","rit_") ;
  riunif = (rxode2i2_fn2)R_GetCCallable("rxode2","riunif") ;
  riweibull = (rxode2i2_fn2)R_GetCCallable("rxode2","riweibull");
    
  phi = (rxode2_fn)R_GetCCallable("rxode2","phi");
  gammap = (rxode2_fn2) R_GetCCallable("rxode2","gammap");
  gammaq = (rxode2_fn2) R_GetCCallable("rxode2","gammaq");
  gammapInv = (rxode2_fn2) R_GetCCallable("rxode2","gammapInv");
  gammapInva = (rxode2_fn2) R_GetCCallable("rxode2","gammapInva");
  gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2","gammaqInv");
  gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2","gammaqInva");
  uppergamma = (rxode2_fn2) R_GetCCallable("rxode2","uppergamma");
  lowergamma = (rxode2_fn2) R_GetCCallable("rxode2","lowergamma");
  gammapDer  = (rxode2_fn2) R_GetCCallable("rxode2","gammapDer");
  logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");
  expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");
  simeta =(_simfun) R_GetCCallable("rxode2", "simeta");
  simeps =(_simfun) R_GetCCallable("rxode2", "simeps");
  _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");
  _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");
  _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");
  
  _llikNorm=(rxode2_llikNormFun) R_GetCCallable("rxode2ll","rxLlikNorm");
  _llikNormDmean=(rxode2_llikNormFun) R_GetCCallable("rxode2ll","rxLlikNormDmean");
  _llikNormDsd=(rxode2_llikNormFun) R_GetCCallable("rxode2ll","rxLlikNormDsd");
  
  _llikPois        = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll","rxLlikPois");
  _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll","rxLlikPoisDlambda");
  _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");
  _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");
  _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");
  _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");
  
  _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");
  _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");
  _llikBeta = (rxode2_llikBetaFun)   R_GetCCallable("rxode2ll", "rxLlikBeta");
  _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");
  _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");
  _llikT = (rxode2_llikTFun)   R_GetCCallable("rxode2ll", "rxLlikT");
  _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");
  _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");
  _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");
  _llikChisq    = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");
  _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");
  _llikExp    = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");
  _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");
  _llikF    = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");
  _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");
  _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");
  _llikGeom    = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");
  _llikGeomDp  = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");
  _llikUnif        = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");
  _llikUnifDalpha  = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");
  _llikUnifDbeta   = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");
  _llikWeibull        = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");
  _llikWeibullDshape  = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");
  _llikWeibullDscale   = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");
  _llikGamma        = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");
  _llikGammaDshape  = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");
  _llikGammaDrate   = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");
  _llikCauchy        = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");
  _llikCauchyDlocation  = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");
  _llikCauchyDscale   = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");
  _solveData = _getRxSolve_();
}
void _assignFuns() {
  if (_assign_ptr == NULL){
    _assignFuns0();
  }
}
extern void  mod1__ode_solver_solvedata (rx_solve *solve){
  _solveData = solve;
}
extern rx_solve *mod1__ode_solver_get_solvedata(){
  return _solveData;
}
SEXP mod1__model_vars();


// prj-specific differential eqns
void mod1__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)
{
  int _itwhile = 0;
  (void)_itwhile;
  int _cSub = _neq[1];
  double t = __t + _solveData->subjects[_neq[1]].curShift;
  (void)t;
  (&_solveData->subjects[_cSub])->_rxFlag=1;
    double C2;
  double centr;
  double V2;
  double C3;
  double peri;
  double V3;
  double depot;
  double KA;
  double CL;
  double Q;
  double eff;
  double Kin;
  double Kout;
  double EC50;

  (void)t;
  (void)C2;
  (void)centr;
  (void)V2;
  (void)C3;
  (void)peri;
  (void)V3;
  (void)depot;
  (void)KA;
  (void)CL;
  (void)Q;
  (void)eff;
  (void)Kin;
  (void)Kout;
  (void)EC50;

  C2 = _PL[0];
  C3 = _PL[1];

  _update_par_ptr(__t, _cSub, _solveData, _idx);
  V2 = _PP[0];
  V3 = _PP[1];
  KA = _PP[2];
  CL = _PP[3];
  Q = _PP[4];
  Kin = _PP[5];
  Kout = _PP[6];
  EC50 = _PP[7];

  depot = __zzStateVar__[0]*((double)(_ON[0]));
  centr = __zzStateVar__[1]*((double)(_ON[1]));
  peri = __zzStateVar__[2]*((double)(_ON[2]));
  eff = __zzStateVar__[3]*((double)(_ON[3]));

  C2=centr/safe_zero(V2);
  C3=peri/safe_zero(V3);
  __DDtStateVar__[0] = ((double)(_ON[0]))*(_IR[0] -KA*depot);
  __DDtStateVar__[1] = ((double)(_ON[1]))*(_IR[1] + KA*depot-CL*C2-Q*C2+Q*C3);
  __DDtStateVar__[2] = ((double)(_ON[2]))*(_IR[2] + Q*C2-Q*C3);
  __DDtStateVar__[3] = ((double)(_ON[3]))*(_IR[3] + Kin-Kout*(1-C2/safe_zero((EC50+C2)))*eff);
  (&_solveData->subjects[_cSub])->dadt_counter[0]++;
}

// Jacobian derived vars
void mod1__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {
  int _itwhile = 0;
  (void)_itwhile;
    int _cSub=_neq[1];
  double t = __t + _solveData->subjects[_neq[1]].curShift;
  (void)t;
  (&_solveData->subjects[_cSub])->_rxFlag=2;
    (&_solveData->subjects[_cSub])->jac_counter[0]++;
}
// Functional based initial conditions.
void mod1__inis(int _cSub, double *__zzStateVar__){
  int _itwhile = 0;
  (void)_itwhile;
  
  (&_solveData->subjects[_cSub])->_rxFlag=3;
  }
// prj-specific derived vars
void mod1__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {
    int _itwhile = 0;
  (void)_itwhile;
  double t = __t + _solveData->subjects[_cSub].curShift;
  (void)t;
  (&_solveData->subjects[_cSub])->_rxFlag=11;
    double  __DDtStateVar_0__;
  double  __DDtStateVar_1__;
  double  __DDtStateVar_2__;
  double  __DDtStateVar_3__;
  double C2;
  double centr;
  double V2;
  double C3;
  double peri;
  double V3;
  double depot;
  double KA;
  double CL;
  double Q;
  double eff;
  double Kin;
  double Kout;
  double EC50;

  (void)t;
  (void)__DDtStateVar_0__;
  (void)__DDtStateVar_1__;
  (void)__DDtStateVar_2__;
  (void)__DDtStateVar_3__;
  (void)C2;
  (void)centr;
  (void)V2;
  (void)C3;
  (void)peri;
  (void)V3;
  (void)depot;
  (void)KA;
  (void)CL;
  (void)Q;
  (void)eff;
  (void)Kin;
  (void)Kout;
  (void)EC50;

  C2 = _PL[0];
  C3 = _PL[1];

  _update_par_ptr(__t, _cSub, _solveData, _idx);
  V2 = _PP[0];
  V3 = _PP[1];
  KA = _PP[2];
  CL = _PP[3];
  Q = _PP[4];
  Kin = _PP[5];
  Kout = _PP[6];
  EC50 = _PP[7];

  depot = __zzStateVar__[0]*((double)(_ON[0]));
  centr = __zzStateVar__[1]*((double)(_ON[1]));
  peri = __zzStateVar__[2]*((double)(_ON[2]));
  eff = __zzStateVar__[3]*((double)(_ON[3]));

  C2=centr/safe_zero(V2);
  C3=peri/safe_zero(V3);
  __DDtStateVar_0__ = ((double)(_ON[0]))*(_IR[0] -KA*depot);
  __DDtStateVar_1__ = ((double)(_ON[1]))*(_IR[1] + KA*depot-CL*C2-Q*C2+Q*C3);
  __DDtStateVar_2__ = ((double)(_ON[2]))*(_IR[2] + Q*C2-Q*C3);
  __DDtStateVar_3__ = ((double)(_ON[3]))*(_IR[3] + Kin-Kout*(1-C2/safe_zero((EC50+C2)))*eff);

  _lhs[0]=C2;
  _lhs[1]=C3;
}
// Functional based bioavailability
double mod1__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){
 return _amt;
  }
// Functional based absorption lag
double mod1__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){
 return __t;
}
// Modeled zero-order rate
double mod1__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){
 return 0.0;
}
// Modeled zero-order duration
double mod1__Dur(int _cSub,  int _cmt, double _amt, double __t){
 return 0.0;
}
// Model Times
void mod1__mtime(int _cSub, double *_mtime){
}
// Matrix Exponential (0)
void mod1__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){
  int _itwhile = 0;
  (void)_itwhile;
  double t = __t + _solveData->subjects[_cSub].curShift;
  (void)t;
  (&_solveData->subjects[_cSub])->_rxFlag=9;
  }
// Inductive linearization Matf
void mod1__IndF(int _cSub, double _t, double __t, double *_matf){
 int _itwhile = 0;
  (void)_itwhile;
  double t = __t + _solveData->subjects[_cSub].curShift;
  (void)t;
  (&_solveData->subjects[_cSub])->_rxFlag=10;
  }
extern SEXP mod1__model_vars(){
  int pro=0;
  SEXP _mv = PROTECT(_rxGetModelLib("mod1__model_vars"));pro++;
  if (!_rxIsCurrentC(_mv)){
    SEXP hash    = PROTECT(allocVector(STRSXP, 1));pro++;
#define __doBuf__  sprintf(buf, "un]\"BAAA@QRtHACAAAAAAAv(yAAAv7#aT)xX$wMA\?,d,ft~kaBaiiqAA6y@P[W41s_i\"p~>`Vw=2y+`5.Ua.xBdJ!C|Bov|ik(H^me20u7*DWIcN}D_QYzUD&AJDDX+>mZ[t;*1ZO+{85<2;;2VUq]pK5YJ6i@+hV$P@T|o:8$AQFQ:f5(.6$#X64e7s#JmULQi!:fSk|5&[@h9ko\?cbct@!.<P;)i=Vh`;PR6H<LHrcq~I5[x|4_gn`G:4k]3d_xY*^LY/xNUvu<N{O:WM|((eyZ,uf<X>JrBPvt9YR<Aj1kb7tF_3pPaI!)X&/7XtJeaa*^G(mew;g%%/\"C8\?H8S..FK!G/7Co,hgXwyG\?&CzC4)D;,le]JL4I,EZo0|\"{J&dTT9Y_F=8tPh^!X^jAft`gBWQmw]WP+W0VUGO\?[&W[TWGB=QP\?5)f2c|dx[t6\"&N/{9Ldv4{;SN9kAg;|k7}aLA4EWQlDbUB*fipl}(Z7ZS&Vo#Fn.3,lOcrD,vnerl7sP;:<P4`z.R$aM|]\?{z,>3JGJ4<>L#dob*TAKAF_QY<aJi45ocI8qu[.$D;cn7Ct_^>8o$96;\?]Nv<KtFg:g[h2Ob{XyT%%1:f*zZ.Db}#U<`I=Dc^kj/L@W@%%TO4b~/@8;5s%%bOneY/mG){y[CV`6ptm^[R2[0R4,6Aj%%2K7QN//99SjHm5qgd<@*o&C~Zn:Zu#~`pk>j|B[;1sq*WhR>+w:!$:o%%w`!m}o_3+Xk>9y<<fF%%5%%u~lPz2`;|5[\"VTX*VP39xFqXe8Eax~IYdB2D6_7CJeGWO3dMr\"C15uccLX2zd;*$u\"lUnTpit(<hX7J|0wdREO$V|f;.RW_{w{|j2SaRrt!\"<2pVL&1YF}vE!rRn0!xFP.+_^UVZqmy:OaI#R|,;7S(*hmNU7Oc|,V*YcIJ!y_Q{+8fc^>Nm&q+Ls(hJE,7=oGY/g`=cv^/EAY9\"l^FLF>^|*9k;7FQPZ/Tb2\"HipNN\"OASWI^Tr4_XwR~U464B!/Z&DN3$lZcl.usH]\"RJY");
    char buf[1040];
    __doBuf__
#undef __doBuf__
    SET_STRING_ELT(hash, 0, mkChar(buf));
    SEXP lst      = PROTECT(_rxQr(hash));pro++;
    _assign_ptr(lst);
    UNPROTECT(pro);
    return lst;
  } else {
    UNPROTECT(pro);
    return _mv;
  }
}
extern void mod1__dydt_lsoda(int *neq, double *t, double *A, double *DADT)
{
  mod1__dydt(neq, *t, A, DADT);
}
extern int mod1__dydt_liblsoda(double __t, double *y, double *ydot, void *data)
{
  int *neq = (int*)(data);
  mod1__dydt(neq, __t, y, ydot);
  return(0);
}
extern void mod1__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){
  // Update all covariate parameters
  mod1__calc_jac(neq, *t, A, JAC, *nrowpd);
}

//Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.
extern void mod1__assignFuns(){
  _assignFuns();
}

//Initialize the dll to match rxode2's calls
void R_init0_mod1_(){
  // Get C callables on load; Otherwise it isn't thread safe
  R_RegisterCCallable("mod1_","mod1__assignFuns", (DL_FUNC) mod1__assignFuns);
  R_RegisterCCallable("mod1_","mod1__inis",(DL_FUNC) mod1__inis);
  R_RegisterCCallable("mod1_","mod1__dydt",(DL_FUNC) mod1__dydt);
  R_RegisterCCallable("mod1_","mod1__calc_lhs",(DL_FUNC) mod1__calc_lhs);
  R_RegisterCCallable("mod1_","mod1__calc_jac",(DL_FUNC) mod1__calc_jac);
  R_RegisterCCallable("mod1_","mod1__dydt_lsoda", (DL_FUNC) mod1__dydt_lsoda);
  R_RegisterCCallable("mod1_","mod1__calc_jac_lsoda", (DL_FUNC) mod1__calc_jac_lsoda);
  R_RegisterCCallable("mod1_","mod1__ode_solver_solvedata", (DL_FUNC) mod1__ode_solver_solvedata);
  R_RegisterCCallable("mod1_","mod1__ode_solver_get_solvedata", (DL_FUNC) mod1__ode_solver_get_solvedata);
  R_RegisterCCallable("mod1_","mod1__F", (DL_FUNC) mod1__F);
  R_RegisterCCallable("mod1_","mod1__Lag", (DL_FUNC) mod1__Lag);
  R_RegisterCCallable("mod1_","mod1__Rate", (DL_FUNC) mod1__Rate);
  R_RegisterCCallable("mod1_","mod1__Dur", (DL_FUNC) mod1__Dur);
  R_RegisterCCallable("mod1_","mod1__mtime", (DL_FUNC) mod1__mtime);
  R_RegisterCCallable("mod1_","mod1__ME", (DL_FUNC) mod1__ME);
  R_RegisterCCallable("mod1_","mod1__IndF", (DL_FUNC) mod1__IndF);
  R_RegisterCCallable("mod1_","mod1__dydt_liblsoda", (DL_FUNC) mod1__dydt_liblsoda);
}
//Initialize the dll to match rxode2's calls
void R_init_mod1_(DllInfo *info){
  // Get C callables on load; Otherwise it isn't thread safe
  R_init0_mod1_();
  static const R_CallMethodDef callMethods[]  = {
    {"mod1__model_vars", (DL_FUNC) &mod1__model_vars, 0},
    {NULL, NULL, 0}
  };

  R_registerRoutines(info, NULL, callMethods, NULL, NULL);
  R_useDynamicSymbols(info,FALSE);
  _assignFuns0();

}

void R_unload_mod1_ (DllInfo *info){
  // Free resources required for single subject solve.
  SEXP _mv = PROTECT(_rxGetModelLib("mod1__model_vars"));
  if (!isNull(_mv)){
    _rxRmModelLib("mod1__model_vars");
  }
  UNPROTECT(1);
}
