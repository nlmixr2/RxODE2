<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Facilities for running simulations from ordinary
    differential equation (ODE) models, such as pharmacometrics and other
    compartmental models.  A compilation manager translates the ODE model
    into C, compiles it, and dynamically loads the object code into R for
    improved computational efficiency.  An event table object facilitates
    the specification of complex dosing regimens (optional) and sampling
    schedules.  NB: The use of this package requires both C and
    Fortran compilers, for details on their use with R please see
    Section 6.3, Appendix A, and Appendix D in the "R Administration and
    Installation" manual. Also the code is mostly released under GPL.  The
    VODE and LSODA are in the public domain.  The information is available
    in the inst/COPYRIGHTS. '>
<title>Facilities for Simulating from ODE-Based Models • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Facilities for Simulating from ODE-Based Models">
<meta property="og:description" content='Facilities for running simulations from ordinary
    differential equation (ODE) models, such as pharmacometrics and other
    compartmental models.  A compilation manager translates the ODE model
    into C, compiles it, and dynamically loads the object code into R for
    improved computational efficiency.  An event table object facilitates
    the specification of complex dosing regimens (optional) and sampling
    schedules.  NB: The use of this package requires both C and
    Fortran compilers, for details on their use with R please see
    Section 6.3, Appendix A, and Appendix D in the "R Administration and
    Installation" manual. Also the code is mostly released under GPL.  The
    VODE and LSODA are in the public domain.  The information is available
    in the inst/COPYRIGHTS. '>
<meta property="og:image" content="https://nlmixr2.github.io/rxode2/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.11.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fas fa fas fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <h6 class="dropdown-header" data-toc-skip>Getting started</h6>
    <a class="dropdown-item" href="articles/rxode2-syntax.html">rxode2 mini language syntax</a>
    <a class="dropdown-item" href="articles/rxode2-pipeline.html">rxode2 with piping ie %&gt;%</a>
    <a class="dropdown-item" href="articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a>
    <a class="dropdown-item" href="articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a>
    <a class="dropdown-item" href="articles/rxode2-plot.html">Plotting with rxode2</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6>
    <a class="dropdown-item" href="articles/rxode2-model-types.html">rxode2 model types</a>
    <a class="dropdown-item" href="articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a>
    <a class="dropdown-item" href="articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a>
    <a class="dropdown-item" href="articles/rxode2-shiny.html">Using Shiny with rxode2</a>
    <a class="dropdown-item" href="articles/rxode2-covariates.html">rxode2 covariates</a>
    <a class="dropdown-item" href="articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a>
    <a class="dropdown-item" href="articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--dosing-events">
    <span class="fas fa fas fa-stethoscope"></span>
     
    Dosing/Events
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--dosing-events">
    <a class="dropdown-item" href="articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a>
    <a class="dropdown-item" href="articles/rxode2-event-types.html">Supported Event Types</a>
    <a class="dropdown-item" href="articles/rxode2-event-table.html">Easy rxode2 Event Tables</a>
    <a class="dropdown-item" href="articles/rxode2-events-classic.html">Classic rxode2 events explained</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--simulations">
    <span class="fas fa fas fa-desktop"></span>
     
    Simulations
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--simulations">
    <a class="dropdown-item" href="articles/rxode2-single-subject.html">Single Subject ODE solving</a>
    <a class="dropdown-item" href="articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a>
    <a class="dropdown-item" href="articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--help">
    <span class="fas fa fas fa-life-ring"></span>
     
    Help
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--help">
    <a class="dropdown-item" href="articles/rxode2-tutorials.html">Running the interactive tutorials</a>
    <a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a>
    <a class="dropdown-item" href="articles/rxode2-wt.html">Weight Based Dosing</a>
    <a class="dropdown-item" href="articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="news/index.html">Changes/News</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--">
    <span class="fas fa fas fa-archive"></span>
     
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--">
    <a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a>
    <a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rxode2">rxode2<a class="anchor" aria-label="anchor" href="#rxode2"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>rxode2</strong> is an R package for solving and simulating from ode-based models. These models are convert the rxode2 mini-language to C and create a compiled dll for fast solving. ODE solving using rxode2 has a few key parts:</p>
<ul>
<li>
<code><a href="reference/rxode2.html">rxode2()</a></code> which creates the C code for fast ODE solving based on a <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-syntax.html">simple syntax</a> related to Leibnitz notation.</li>
<li>The event data, which can be:
<ul>
<li>a <code>NONMEM</code> or <code>deSolve</code> <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-event-types.html">compatible data frame</a>, or</li>
<li>created with <code><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et()</a></code> or <code><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable()</a></code> for <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-event-table.html">easy simulation of events</a>
</li>
<li>The data frame can be augmented by adding <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-covariates.html#time-varying-covariates">time-varying</a> or adding <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-covariates.html#individual-covariates">individual covariates</a> (<code>iCov=</code> as needed)</li>
</ul>
</li>
<li>
<code><a href="reference/rxSolve.html">rxSolve()</a></code> which solves the system of equations using initial conditions and parameters to make predictions
<ul>
<li>With multiple subject data, <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-speed.html">this may be parallelized</a>.</li>
<li>With single subject the <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-data-frame.html">output data frame is adaptive</a>
</li>
<li>Covariances and other metrics of uncertanty can be used to <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-sim-var.html">simulate while solving</a>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of rxode2 from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rxode2"</span><span class="op">)</span></span></code></pre></div>
<p>The fastest way to install the development version of <code>rxode2</code> is to use the <code>r-universe</code> service. This service compiles binares of the development version for MacOS and for Windows so you don’t have to wait for package compilation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dparser"</span>, <span class="st">"rxode2ll"</span>, <span class="st">"rxode2parse"</span>,</span>
<span>                   <span class="st">"rxode2random"</span>, <span class="st">"rxode2et"</span>, <span class="st">"rxode2"</span><span class="op">)</span>,</span>
<span>                 repos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nlmixr2<span class="op">=</span><span class="st">"https://nlmixr2.r-universe.dev"</span>,</span>
<span>                         CRAN<span class="op">=</span><span class="st">"https://cloud.r-project.org"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If this doesn’t work you install the development version of rxode2 with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2parse"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2random"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2et"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2ll"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2"</span><span class="op">)</span></span></code></pre></div>
<p>To build models with rxode2, you need a working c compiler. To use parallel threaded solving in rxode2, this c compiler needs to support open-mp.</p>
<p>You can check to see if R has working c compiler you can check with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("pkgbuild")</span></span>
<span><span class="fu">pkgbuild</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/pkgbuild/reference/has_build_tools.html" class="external-link">has_build_tools</a></span><span class="op">(</span>debug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If you do not have the toolchain, you can set it up as described by the platform information below:</p>
<div class="section level3">
<h3 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h3>
<p>In windows you may simply use installr to install rtools:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"installr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/installr/" class="external-link">installr</a></span><span class="op">)</span></span>
<span><span class="fu">install.rtools</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively you can <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">download</a> and install rtools directly.</p>
</div>
<div class="section level3">
<h3 id="mac-osx">Mac OSX<a class="anchor" aria-label="anchor" href="#mac-osx"></a>
</h3>
<p>To get the most speed you need OpenMP enabled and compile rxode2 with that compiler. There are various options and the most up to date discussion about this is likely the <a href="https://github.com/Rdatatable/data.table/wiki/Installation#openmp-enabled-compiler-for-mac" class="external-link">data.table installation faq for MacOS</a>. The last thing to keep in mind is that <code>rxode2</code> uses the code very similar to the original <code>lsoda</code> which requires the <code>gfortran</code> compiler to be setup as well as the <code>OpenMP</code> compilers.</p>
<p>If you are going to be using <code>rxode2</code> and <code>nlmixr</code> together and have an older mac computer, I would suggest trying the following:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/symengine/symengine.R" class="external-link">symengine</a></span><span class="op">)</span></span></code></pre></div>
<p>If this crashes your R session then the binary does not work with your Mac machine. To be able to run nlmixr, you will need to compile this package manually. I will proceed assuming you have <code>homebrew</code> installed on your system.</p>
<p>On your system terminal you will need to install the dependencies to compile <code>symengine</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install cmake gmp mpfr libmpc</span></code></pre></div>
<p>After installing the dependencies, you need to reinstall <code>symengine</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"symengine"</span>, type<span class="op">=</span><span class="st">"source"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/symengine/symengine.R" class="external-link">symengine</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="linux">Linux<a class="anchor" aria-label="anchor" href="#linux"></a>
</h3>
<p>To install on linux make sure you install <code>gcc</code> (with openmp support) and <code>gfortran</code> using your distribution’s package manager.</p>
</div>
</div>
<div class="section level2">
<h2 id="development-version">Development Version<a class="anchor" aria-label="anchor" href="#development-version"></a>
</h2>
<p>Since the development version of rxode2 uses StanHeaders, you will need to make sure your compiler is setup to support C++14, as described in the <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#configuration-of-the-c-toolchain" class="external-link">rstan setup page</a>. For R 4.0, I do not believe this requires modifying the windows toolchain any longer (so it is much easier to setup).</p>
<p>Once the C++ toolchain is setup appropriately, you can install the development version from <a href="https://github.com/nlmixr2/rxode2" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2parse"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2random"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2et"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2ll"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nlmixr2/rxode2"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="illustrated-example">Illustrated Example<a class="anchor" aria-label="anchor" href="#illustrated-example"></a>
</h1>
<p>The model equations can be specified through a text string, a model file or an R expression. Both differential and algebraic equations are permitted. Differential equations are specified by <code>d/dt(var_name) =</code>. Each equation can be separated by a semicolon.</p>
<p>To load <code>rxode2</code> package and compile the model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 2.0.11.9000 using 4 threads (see ?getRxThreads)</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">C2</span> <span class="op">&lt;-</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span>;</span>
<span>  <span class="va">C3</span> <span class="op">&lt;-</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span>;</span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span>;</span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span>;</span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span>;</span>
<span>  <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span>;</span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="specify-ode-parameters-and-initial-conditions">Specify ODE parameters and initial conditions<a class="anchor" aria-label="anchor" href="#specify-ode-parameters-and-initial-conditions"></a>
</h2>
<p>Model parameters can be defined as named vectors. Names of parameters in the vector must be a superset of parameters in the ODE model, and the order of parameters within the vector is not important.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> </span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>KA<span class="op">=</span><span class="fl">2.94E-01</span>, CL<span class="op">=</span><span class="fl">1.86E+01</span>, V2<span class="op">=</span><span class="fl">4.02E+01</span>, <span class="co"># central </span></span>
<span>     Q<span class="op">=</span><span class="fl">1.05E+01</span>,  V3<span class="op">=</span><span class="fl">2.97E+02</span>,              <span class="co"># peripheral</span></span>
<span>     Kin<span class="op">=</span><span class="fl">1</span>, Kout<span class="op">=</span><span class="fl">1</span>, EC50<span class="op">=</span><span class="fl">200</span><span class="op">)</span>               <span class="co"># effects</span></span></code></pre></div>
<p>Initial conditions (ICs) can be defined through a vector as well. If the elements are not specified, the initial condition for the compartment is assumed to be zero.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>eff<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>If you want to specify the initial conditions in the model you can add:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eff</span>(<span class="dv">0</span>) <span class="ot">=</span> <span class="dv">1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-dosing-and-sampling-in-rxode2">Specify Dosing and sampling in rxode2<a class="anchor" aria-label="anchor" href="#specify-dosing-and-sampling-in-rxode2"></a>
</h2>
<p><code>rxode2</code> provides a simple and very flexible way to specify dosing and sampling through functions that generate an event table. First, an empty event table is generated through the “eventTable()” function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">'mg'</span>, time.units<span class="op">=</span><span class="st">'hours'</span><span class="op">)</span></span></code></pre></div>
<p>Next, use the <code><a href="https://nlmixr2.github.io/rxode2et/reference/add.dosing.html">add.dosing()</a></code> and <code><a href="https://nlmixr2.github.io/rxode2et/reference/add.sampling.html">add.sampling()</a></code> functions of the <code>EventTable</code> object to specify the dosing (amounts, frequency and/or times, etc.) and observation times at which to sample the state of the system. These functions can be called multiple times to specify more complex dosing or sampling regiments. Here, these functions are used to specify 10mg BID dosing for 5 days, followed by 20mg QD dosing for 5 days:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span>dose<span class="op">=</span><span class="fl">10000</span>, nbr.doses<span class="op">=</span><span class="fl">10</span>, dosing.interval<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span>dose<span class="op">=</span><span class="fl">20000</span>, nbr.doses<span class="op">=</span><span class="fl">5</span>, start.time<span class="op">=</span><span class="fl">120</span>,</span>
<span>              dosing.interval<span class="op">=</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">ev</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span></span></code></pre></div>
<p>If you wish you can also do this with the <code>mattigr</code> pipe operator <code>%&gt;%</code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/eventTable.html">eventTable</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">"mg"</span>, time.units<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/add.dosing.html">add.dosing</a></span><span class="op">(</span>dose<span class="op">=</span><span class="fl">10000</span>, nbr.doses<span class="op">=</span><span class="fl">10</span>, dosing.interval<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/add.dosing.html">add.dosing</a></span><span class="op">(</span>dose<span class="op">=</span><span class="fl">20000</span>, nbr.doses<span class="op">=</span><span class="fl">5</span>, start.time<span class="op">=</span><span class="fl">120</span>,</span>
<span>             dosing.interval<span class="op">=</span><span class="fl">24</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/add.sampling.html">add.sampling</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span></span></code></pre></div>
<p>The functions <code>get.dosing()</code> and <code>get.sampling()</code> can be used to retrieve information from the event table.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ev</span><span class="op">$</span><span class="fu">get.dosing</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id low time high       cmt   amt rate ii addl evid ss dur</span></span>
<span><span class="co">#&gt; 1  1  NA    0   NA (default) 10000    0 12    9    1  0   0</span></span>
<span><span class="co">#&gt; 2  1  NA  120   NA (default) 20000    0 24    4    1  0   0</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ev</span><span class="op">$</span><span class="fu">get.sampling</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id low time high   cmt amt rate ii addl evid ss dur</span></span>
<span><span class="co">#&gt; 1  1  NA    0   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span>
<span><span class="co">#&gt; 2  1  NA    1   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span>
<span><span class="co">#&gt; 3  1  NA    2   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span>
<span><span class="co">#&gt; 4  1  NA    3   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span>
<span><span class="co">#&gt; 5  1  NA    4   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span>
<span><span class="co">#&gt; 6  1  NA    5   NA (obs)  NA   NA NA   NA    0 NA  NA</span></span></code></pre></div>
<p>You may notice that these are similar to NONMEM event tables; If you are more familiar with NONMEM data and events you could use them directly with the event table function <code>et</code></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>,ii<span class="op">=</span><span class="fl">12</span>,cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">120</span>, amt<span class="op">=</span><span class="fl">2000</span>, addl<span class="op">=</span><span class="fl">4</span>, ii<span class="op">=</span><span class="fl">14</span>, cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://nlmixr2.github.io/rxode2et/reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co"># Add sampling </span></span></code></pre></div>
<p>You can see from the above code, you can dose to the compartment named in the rxode2 model. This slight deviation from NONMEM can reduce the need for compartment renumbering.</p>
<p>These events can also be combined and expanded (to multi-subject events and complex regimens) with <code>rbind</code>, <code>c</code>, <code>seq</code>, and <code>rep</code>. For more information about creating complex dosing regimens using rxode2 see the <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-event-types.html">rxode2 events vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="solving-odes">Solving ODEs<a class="anchor" aria-label="anchor" href="#solving-odes"></a>
</h2>
<p>The ODE can now be solved by calling the model object’s <code>run</code> or <code>solve</code> function. Simulation results for all variables in the model are stored in the output matrix x.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="va">theta</span>, <span class="va">ev</span>, <span class="va">inits</span><span class="op">)</span>;</span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="14%">
<col width="16%">
<col width="16%">
<col width="14%">
<col width="16%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">time</th>
<th align="right">C2</th>
<th align="right">C3</th>
<th align="right">depot</th>
<th align="right">centr</th>
<th align="right">peri</th>
<th align="right">eff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.00000</td>
<td align="right">0.0000000</td>
<td align="right">10000.000</td>
<td align="right">0.000</td>
<td align="right">0.0000</td>
<td align="right">1.000000</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">44.37555</td>
<td align="right">0.9198298</td>
<td align="right">7452.765</td>
<td align="right">1783.897</td>
<td align="right">273.1895</td>
<td align="right">1.084664</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">54.88296</td>
<td align="right">2.6729825</td>
<td align="right">5554.370</td>
<td align="right">2206.295</td>
<td align="right">793.8758</td>
<td align="right">1.180825</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">51.90343</td>
<td align="right">4.4564927</td>
<td align="right">4139.542</td>
<td align="right">2086.518</td>
<td align="right">1323.5783</td>
<td align="right">1.228914</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">44.49738</td>
<td align="right">5.9807076</td>
<td align="right">3085.103</td>
<td align="right">1788.795</td>
<td align="right">1776.2702</td>
<td align="right">1.234610</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">36.48434</td>
<td align="right">7.1774981</td>
<td align="right">2299.255</td>
<td align="right">1466.670</td>
<td align="right">2131.7169</td>
<td align="right">1.214742</td>
</tr>
</tbody>
</table>
<p>You can also solve this and create a rxode2 data frame:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mod1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">ev</span>, <span class="va">inits</span><span class="op">)</span>;</span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; ── Solved rxode2 object ──</span></span>
<span><span class="co">#&gt; ── Parameters (x$params): ──</span></span>
<span><span class="co">#&gt;      V2      V3      KA      CL       Q     Kin    Kout    EC50 </span></span>
<span><span class="co">#&gt;  40.200 297.000   0.294  18.600  10.500   1.000   1.000 200.000 </span></span>
<span><span class="co">#&gt; ── Initial Conditions (x$inits): ──</span></span>
<span><span class="co">#&gt; depot centr  peri   eff </span></span>
<span><span class="co">#&gt;     0     0     0     1 </span></span>
<span><span class="co">#&gt; ── First part of data (object): ──</span></span>
<span><span class="co">#&gt; # A tibble: 241 × 7</span></span>
<span><span class="co">#&gt;   time    C2    C3  depot centr  peri   eff</span></span>
<span><span class="co">#&gt;    [h] &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1    0   0   0     10000     0     0   1   </span></span>
<span><span class="co">#&gt; 2    1  44.4 0.920  7453. 1784.  273.  1.08</span></span>
<span><span class="co">#&gt; 3    2  54.9 2.67   5554. 2206.  794.  1.18</span></span>
<span><span class="co">#&gt; 4    3  51.9 4.46   4140. 2087. 1324.  1.23</span></span>
<span><span class="co">#&gt; 5    4  44.5 5.98   3085. 1789. 1776.  1.23</span></span>
<span><span class="co">#&gt; 6    5  36.5 7.18   2299. 1467. 2132.  1.21</span></span>
<span><span class="co">#&gt; # … with 235 more rows</span></span></code></pre></div>
<p>This returns a modified data frame. You can see the compartment values in the plot below:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">C2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Central Concentration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-intro-central-1.png" width="100%"></p>
<p>Or,</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">eff</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Effect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-intro-effect-1.png" width="100%"></p>
<p>Note that the labels are automatically labeled with the units from the initial event table. rxode2 extracts <code>units</code> to label the plot (if they are present).</p>
</div>
</div>
<div class="section level1">
<h1 id="related-r-packages">Related R Packages<a class="anchor" aria-label="anchor" href="#related-r-packages"></a>
</h1>
<div class="section level2">
<h2 id="ode-solving">ODE solving<a class="anchor" aria-label="anchor" href="#ode-solving"></a>
</h2>
<p>This is a brief comparison of pharmacometric ODE solving R packages to <code>rxode2</code>.</p>
<p>There are several <a href="https://CRAN.R-project.org/view=DifferentialEquations" class="external-link">R packages for differential equations</a>. The most popular is <a href="https://CRAN.R-project.org/package=deSolve" class="external-link">deSolve</a>.</p>
<p>However for pharmacometrics-specific ODE solving, there are only 2 packages other than <a href="https://cran.r-project.org/package=rxode2" class="external-link">rxode2</a> released on CRAN. Each uses compiled code to have faster ODE solving.</p>
<ul>
<li>
<p><a href="https://cran.r-project.org/package=mrgsolve" class="external-link">mrgsolve</a>, which uses C++ lsoda solver to solve ODE systems. The user is required to write hybrid R/C++ code to create a mrgsolve model which is translated to C++ for solving.</p>
<p>In contrast, <code>rxode2</code> has a R-like mini-language that is parsed into C code that solves the ODE system.</p>
<p>Unlike <code>rxode2</code>, <code>mrgsolve</code> does not currently support symbolic manipulation of ODE systems, like automatic Jacobian calculation or forward sensitivity calculation (<code>rxode2</code> currently supports this and this is the basis of <a href="https://CRAN.R-project.org/package=nlmixr2" class="external-link">nlmixr2</a>’s FOCEi algorithm)</p>
</li>
<li>
<p><a href="https://CRAN.R-project.org/package=dMod" class="external-link">dMod</a>, which uses a unique syntax to create “reactions”. These reactions create the underlying ODEs and then created c code for a compiled deSolve model.</p>
<p>In contrast <code>rxode2</code> defines ODE systems at a lower level. <code>rxode2</code>’s parsing of the mini-language comes from C, whereas <code>dMod</code>’s parsing comes from R.</p>
<p>Like <code>rxode2</code>, <code>dMod</code> supports symbolic manipulation of ODE systems and calculates forward sensitivities and adjoint sensitivities of systems.</p>
<p>Unlike <code>rxode2</code>, <code>dMod</code> is not thread-safe since <code>deSolve</code> is not yet thread-safe.</p>
</li>
<li>
<p><a href="https://github.com/InsightRX/PKPDsim" class="external-link">PKPDsim</a> which defines models in an R-like syntax and converts the system to compiled code.</p>
<p>Like <code>mrgsolve</code>, <code>PKPDsim</code> does not currently support symbolic manipulation of ODE systems.</p>
<p><code>PKPDsim</code> is not thread-safe.</p>
</li>
</ul>
<p>The open pharmacometrics open source community is fairly friendly, and the rxode2 maintainers has had positive interactions with all of the ODE-solving pharmacometric projects listed.</p>
</div>
<div class="section level2">
<h2 id="pk-solved-systems">PK Solved systems<a class="anchor" aria-label="anchor" href="#pk-solved-systems"></a>
</h2>
<p><code>rxode2</code> supports 1-3 compartment models with gradients (using stan math’s auto-differentiation). This currently uses the same equations as <code>PKADVAN</code> to allow time-varying covariates.</p>
<p><code>rxode2</code> can mix ODEs and solved systems.</p>
<div class="section level3">
<h3 id="the-following-packages-for-solved-pk-systems-are-on-cran">The following packages for solved PK systems are on CRAN<a class="anchor" aria-label="anchor" href="#the-following-packages-for-solved-pk-systems-are-on-cran"></a>
</h3>
<ul>
<li><p><a href="https://cran.r-project.org/package=mrgsolve" class="external-link">mrgsolve</a> currently has 1-2 compartment (poly-exponential models) models built-in. The solved systems and ODEs cannot currently be mixed.</p></li>
<li><p><a href="https://github.com/kestrel99/pmxTools" class="external-link">pmxTools</a> currently have 1-3 compartment (super-positioning) models built-in. This is a R-only implementation.</p></li>
<li><p><a href="https://github.com/InsightRX/PKPDsim" class="external-link">PKPDsim</a> uses 1-3 “ADVAN” solutions using non-superpositioning.</p></li>
<li><p><a href="https://CRAN.R-project.org/package=PKPDmodels" class="external-link">PKPDmodels</a> has a one-compartment model with gradients.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="non-cran-libraries">Non-CRAN libraries:<a class="anchor" aria-label="anchor" href="#non-cran-libraries"></a>
</h3>
<ul>
<li>
<a href="https://github.com/abuhelwa/PKADVAN_Rpackage" class="external-link">PKADVAN</a> Provides 1-3 compartment models using non-superpositioning. This allows time-varying covariates.</li>
</ul>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rxode2" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/nlmixr2/rxode2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/nlmixr2/rxode2/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3) </li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rxode2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matthew L. Fidler <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8538-6691" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Melissa Hallow <br><small class="roles"> Author </small>  </li>
<li>Wenping Wang <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/nlmixr2/rxode2/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/nlmixr2/rxode2/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/nlmixr2/rxode2?branch=main" class="external-link"><img src="https://codecov.io/gh/nlmixr2/rxode2/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://cran.r-project.org/package=rxode2" class="external-link"><img src="http://www.r-pkg.org/badges/version/rxode2" alt="CRAN version"></a></li>
<li><a href="https://cran.r-project.org/package=rxode2" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/rxode2" alt="CRAN total downloads"></a></li>
<li><a href="https://cran.r-project.org/package=rxode2" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/rxode2" alt="CRAN total downloads"></a></li>
<li><a href="https://www.codefactor.io/repository/github/nlmixr2/rxode2" class="external-link"><img src="https://www.codefactor.io/repository/github/nlmixr2/rxode2/badge" alt="CodeFactor"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew L. Fidler, Melissa Hallow, Wenping Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
